<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Mission: Get to Space</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap');

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Orbitron', sans-serif;
      background: linear-gradient(120deg, #0f0f0f, #1a1a1a);
      color: white;
      height: 100vh;
      overflow: hidden;
    }

    .screen {
      display: none;
      height: 100vh;
      width: 100vw;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      text-align: center;
    }

    .visible {
      display: flex;
    }

    h1 {
      font-size: 3em;
      color: #00eaff;
      text-shadow: 0 0 20px #00eaff, 0 0 40px #00eaff;
      margin-bottom: 20px;
    }

    p {
      font-size: 1.2em;
      max-width: 500px;
      margin-bottom: 30px;
    }

    button {
      padding: 12px 30px;
      font-size: 1.3em;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      background: #00eaff;
      color: #000;
      font-weight: bold;
      box-shadow: 0 0 10px #00eaff, 0 0 20px #00eaff;
      transition: transform 0.2s ease, box-shadow 0.3s ease;
      margin: 10px;
    }

    button:hover {
      transform: scale(1.05);
      box-shadow: 0 0 20px #00ffff, 0 0 40px #00ffff;
    }

    .upgrade {
      margin-top: 10px;
      padding: 10px 20px;
      background-color: #43a047;
      border-radius: 8px;
      font-size: 1em;
      border: none;
      color: white;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    .upgrade:hover {
      background-color: #2e7d32;
    }

    .status {
      margin-top: 20px;
      font-size: 1.1em;
    }

    #launchButton {
      background: #fdd835;
      color: black;
    }

    #launchButton:hover {
      background: #fbc02d;
    }

    #testButton {
      background: #8e24aa;
      color: white;
    }

    #testButton:hover {
      background: #6a1b9a;
    }

    #testResult {
      margin-top: 10px;
      color: #00ff99;
      font-size: 1.1em;
    }

    #missionText {
      font-size: 1em;
      margin: 20px 0;
      color: #80deea;
    }

    #invadersCanvas {
      background: #000;
      border: 2px solid #00eaff;
      margin-top: 20px;
      display: none;
    }
  </style>
</head>
<body>

  <!-- Home Screen -->
  <div id="homeScreen" class="screen visible">
    <h1>üöÄ MISSION: GET TO SPACE üöÄ</h1>
    <p>Start in a barn. Complete missions. Gather scraps. Build your shuttle.</p>
    <button onclick="startGame()">Start Mission</button>
  </div>

  <!-- Game Screen -->
  <div id="gameScreen" class="screen">
    <h1>üõ†Ô∏è Barn Workshop</h1>
    <p>Scraps Collected: <span id="scrapCount">0</span></p>

    <div id="missionText">Click "Start Next Mission" to begin...</div>
    <canvas id="invadersCanvas" width="600" height="400"></canvas>
    <button id="missionButton" onclick="startMission()">üéØ Start Next Mission</button>

    <div id="upgradeButtons"></div>

    <div class="status" id="statusText"></div>
    <button id="testButton" onclick="runTest()" style="display: none;">üß™ Run System Test</button>
    <button id="launchButton" onclick="launchShuttle()" style="display: none;">üöÄ Launch to Space!</button>

    <div id="testResult"></div>
  </div>

  <!-- Space Screen -->
  <div id="spaceScreen" class="screen">
    <h1>üåå YOU MADE IT TO SPACE! üåå</h1>
    <p>Congratulations, Commander. Earth is behind you. Stars await.</p>
    <button onclick="location.reload()">Play Again</button>
  </div>

  <script>
    let scraps = 0;
    let invaderGameActive = false;
    let invaderCanvas, invaderCtx;
    let playerShip, invaderBullets, invaders, invaderKeys;

    const missions = [
      { text: "Fix the broken circuit in the control panel", reward: 15 },
      { text: "Search the junkyard for reusable metal", reward: 20 },
      { text: "Help a farmer with drone repairs in exchange for parts", reward: 25 },
      { text: "Decode an old satellite for usable data chips", reward: 18 },
      { text: "Trade spare bolts with a traveling engineer", reward: 22 },
      { text: "Reprogram a scrapyard robot to assist you", reward: 30 },
      { text: "Survive a thunderstorm while collecting parts", reward: 10 },
      { text: "Hack into an abandoned facility for tools", reward: 28 }
    ];

    let shuttleParts = [
      { name: "Base Frame", cost: 20, built: false },
      { name: "Engine", cost: 40, built: false },
      { name: "Fuel Tank", cost: 60, built: false },
      { name: "Cockpit", cost: 80, built: false },
      { name: "Wings", cost: 100, built: false }
    ];

    function startGame() {
      document.getElementById('homeScreen').classList.remove('visible');
      document.getElementById('gameScreen').classList.add('visible');
      renderUpgrades();
    }

    function startMission() {
      if (invaderGameActive) return;
      document.getElementById('missionButton').style.display = 'none';
      document.getElementById('missionText').innerText = 'Destroy the invaders!';
      startInvadersGame();
    }

    function startInvadersGame() {
      invaderGameActive = true;
      invaderCanvas = document.getElementById('invadersCanvas');
      invaderCtx = invaderCanvas.getContext('2d');
      invaderCanvas.style.display = 'block';
      playerShip = { x: invaderCanvas.width / 2 - 15, y: invaderCanvas.height - 30, width: 30, height: 15, speed: 5 };
      invaderBullets = [];
      invaders = [];
      invaderKeys = {};
      for (let r = 0; r < 2; r++) {
        for (let c = 0; c < 5; c++) {
          invaders.push({ x: 60 + c * 80, y: 40 + r * 40, width: 30, height: 20, dx: 1 });
        }
      }
      document.addEventListener('keydown', invaderKeyDown);
      document.addEventListener('keyup', invaderKeyUp);
      requestAnimationFrame(updateInvaders);
    }

    function invaderKeyDown(e) {
      invaderKeys[e.key] = true;
      if (e.key === ' ') {
        invaderBullets.push({ x: playerShip.x + playerShip.width / 2 - 2, y: playerShip.y, width: 4, height: 8, dy: -7 });
      }
    }

    function invaderKeyUp(e) {
      invaderKeys[e.key] = false;
    }

    function updateInvaders() {
      if (!invaderGameActive) return;
      invaderCtx.clearRect(0, 0, invaderCanvas.width, invaderCanvas.height);

      if (invaderKeys['ArrowLeft']) playerShip.x -= playerShip.speed;
      if (invaderKeys['ArrowRight']) playerShip.x += playerShip.speed;
      playerShip.x = Math.max(0, Math.min(invaderCanvas.width - playerShip.width, playerShip.x));
      invaderCtx.fillStyle = '#00eaff';
      invaderCtx.fillRect(playerShip.x, playerShip.y, playerShip.width, playerShip.height);

      invaders.forEach(inv => {
        inv.x += inv.dx;
        if (inv.x + inv.width > invaderCanvas.width || inv.x < 0) {
          inv.dx *= -1;
          inv.y += 10;
        }
        invaderCtx.fillStyle = '#ff1744';
        invaderCtx.fillRect(inv.x, inv.y, inv.width, inv.height);
      });

      invaderBullets.forEach((b, i) => {
        b.y += b.dy;
        invaderCtx.fillStyle = '#fff';
        invaderCtx.fillRect(b.x, b.y, b.width, b.height);
        if (b.y + b.height < 0) invaderBullets.splice(i, 1);
      });

      invaderBullets.forEach((b, bi) => {
        invaders.forEach((inv, ii) => {
          if (b.x < inv.x + inv.width && b.x + b.width > inv.x && b.y < inv.y + inv.height && b.y + b.height > inv.y) {
            invaders.splice(ii, 1);
            invaderBullets.splice(bi, 1);
            scraps += 5;
            document.getElementById('scrapCount').innerText = scraps;
          }
        });
      });

      if (invaders.length === 0) {
        endInvadersGame();
      } else {
        requestAnimationFrame(updateInvaders);
      }
    }

    function endInvadersGame() {
      invaderGameActive = false;
      invaderCanvas.style.display = 'none';
      document.removeEventListener('keydown', invaderKeyDown);
      document.removeEventListener('keyup', invaderKeyUp);
      document.getElementById('missionText').innerText = 'Mission complete! Build your shuttle.';
      document.getElementById('missionButton').style.display = 'inline-block';
      renderUpgrades();
    }

    function renderUpgrades() {
      const upgradeDiv = document.getElementById('upgradeButtons');
      upgradeDiv.innerHTML = '';
      document.getElementById('testResult').innerText = '';

      let allBuilt = true;

      shuttleParts.forEach((part) => {
        if (!part.built) {
          allBuilt = false;
          const btn = document.createElement('button');
          btn.className = 'upgrade';
          btn.innerText = `Build ${part.name} (${part.cost} scraps)`;
          btn.disabled = scraps < part.cost;

          btn.onclick = () => {
            scraps -= part.cost;
            part.built = true;
            document.getElementById('scrapCount').innerText = scraps;
            renderUpgrades();
          };

          upgradeDiv.appendChild(btn);
        }
      });

      if (allBuilt) {
        document.getElementById('statusText').innerText = "‚úÖ All systems built. Run a test before launch!";
        document.getElementById('testButton').style.display = 'inline-block';
        document.getElementById('launchButton').style.display = 'inline-block';
      } else {
        document.getElementById('statusText').innerText = "üîß Complete missions and build your shuttle.";
        document.getElementById('testButton').style.display = 'none';
        document.getElementById('launchButton').style.display = 'none';
      }
    }

    function runTest() {
      document.getElementById('testResult').innerText = "‚úÖ System Check Passed: Engine, Fuel, Navigation ‚Äì All GO!";
    }

    function launchShuttle() {
      document.getElementById('gameScreen').classList.remove('visible');
      document.getElementById('spaceScreen').classList.add('visible');
    }
  </script>

</body>
</html>
